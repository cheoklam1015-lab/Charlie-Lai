<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>賓果數字猜謎遊戲</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 重置樣式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* 主體樣式 */
        body {
            background: linear-gradient(135deg, #1a237e, #4a148c);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        /* 容器樣式 */
        .container {
            max-width: 1000px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-top: 20px;
        }
        
        /* 標題區域 */
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: #ffeb3b;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        /* 主遊戲區域 */
        .main-game-area {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        /* 左側資訊面板 */
        .left-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .game-info-card {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .game-info-title {
            font-size: 1.4rem;
            color: #bb86fc;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .game-info-title i {
            font-size: 1.6rem;
        }
        
        .info-item {
            margin-bottom: 20px;
        }
        
        .info-label {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 8px;
            color: #bb86fc;
        }
        
        .info-value {
            font-size: 2rem;
            font-weight: bold;
            color: #ffeb3b;
            padding: 5px 15px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            display: inline-block;
            min-width: 120px;
        }
        
        .status-playing {
            color: #4CAF50;
        }
        
        .status-won {
            color: #FF9800;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* 右側輸入面板 */
        .right-panel {
            flex: 1;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .input-title {
            font-size: 1.4rem;
            margin-bottom: 25px;
            color: #bb86fc;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-title i {
            font-size: 1.6rem;
        }
        
        .input-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .number-input {
            width: 80px;
            height: 80px;
            font-size: 2.5rem;
            text-align: center;
            border: none;
            border-radius: 15px;
            background-color: rgba(255, 255, 255, 0.9);
            color: #1a237e;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .number-input:focus {
            outline: 3px solid #ffeb3b;
            background-color: white;
            transform: scale(1.05);
        }
        
        .number-input:disabled {
            background-color: rgba(255, 255, 255, 0.5);
            color: rgba(26, 35, 126, 0.5);
        }
        
        /* 按鈕樣式 */
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 16px 32px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-submit {
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            color: white;
        }
        
        .btn-reset {
            background: linear-gradient(to right, #FF9800, #FF5722);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* 歷史猜測表格區域 */
        .history-section {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .history-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #bb86fc;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .history-title i {
            font-size: 1.6rem;
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        
        .history-table th {
            background-color: rgba(187, 134, 252, 0.3);
            color: white;
            padding: 18px 15px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .history-table td {
            padding: 16px 15px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-table tr:last-child td {
            border-bottom: none;
        }
        
        .history-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        /* 表格中的猜測數字樣式 */
        .guess-number {
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 8px;
            color: #ffeb3b;
        }
        
        /* 回饋計數器樣式 */
        .feedback-counter {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2rem;
            min-width: 60px;
        }
        
        .correct-position-counter {
            background-color: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .correct-number-counter {
            background-color: rgba(33, 150, 243, 0.3);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        /* 勝利訊息 */
        .win-message {
            text-align: center;
            font-size: 2rem;
            color: #4CAF50;
            font-weight: bold;
            margin: 20px 0;
            padding: 25px;
            background-color: rgba(76, 175, 80, 0.2);
            border-radius: 15px;
            display: none;
            border: 2px solid #4CAF50;
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 10px #4CAF50; }
            to { box-shadow: 0 0 20px #4CAF50; }
        }
        
        .win-message i {
            margin-right: 15px;
            font-size: 2.2rem;
        }
        
        /* 遊戲說明 */
        .instructions {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 25px;
        }
        
        .instructions h3 {
            color: #bb86fc;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            line-height: 1.6;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        .instructions .highlight {
            color: #ffeb3b;
            font-weight: bold;
        }
        
        /* 響應式設計 */
        @media (max-width: 900px) {
            .main-game-area {
                flex-direction: column;
            }
            
            .left-panel, .right-panel {
                width: 100%;
            }
            
            .number-input {
                width: 70px;
                height: 70px;
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .input-container {
                gap: 15px;
            }
            
            .number-input {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .btn {
                padding: 14px 24px;
                font-size: 1.1rem;
            }
            
            .history-table th, 
            .history-table td {
                padding: 12px 10px;
            }
            
            .guess-number {
                font-size: 1.3rem;
                letter-spacing: 5px;
            }
        }
        
        @media (max-width: 480px) {
            .number-input {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .input-container {
                gap: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
        
        /* 滾動條樣式 */
        .table-container::-webkit-scrollbar {
            height: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: #bb86fc;
            border-radius: 10px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #9c64d4;
        }
        
        /* 數字輸入的焦點指示 */
        .digit-active {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ffeb3b;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-dice"></i> 賓果數字猜謎</h1>
            <p class="subtitle">猜測4位數字。獲得關於正確數字和位置的回饋！</p>
        </header>
        
        <div class="main-game-area">
            <!-- 左側資訊面板 -->
            <div class="left-panel">
                <div class="game-info-card">
                    <h2 class="game-info-title"><i class="fas fa-info-circle"></i> 遊戲資訊</h2>
                    
                    <div class="info-item">
                        <div class="info-label">嘗試次數</div>
                        <div class="info-value" id="attempts">0</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">遊戲時間</div>
                        <div class="info-value" id="timer">00:00</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">遊戲狀態</div>
                        <div class="info-value" id="status">遊戲中</div>
                    </div>
                </div>
                
                <div class="game-info-card">
                    <h2 class="game-info-title"><i class="fas fa-lightbulb"></i> 遊戲提示</h2>
                    <ul class="instructions-list">
                        <li>使用回饋來縮小可能的數字組合</li>
                        <li>先確定正確位置的數字</li>
                        <li>嘗試不同的數字排列組合</li>
                        <li>記錄您之前的猜測以避免重複</li>
                    </ul>
                </div>
            </div>
            
            <!-- 右側輸入面板 -->
            <div class="right-panel">
                <h2 class="input-title"><i class="fas fa-keyboard"></i> 輸入您的猜測</h2>
                
                <div class="input-container">
                    <input type="number" min="0" max="9" class="number-input" id="digit1" maxlength="1">
                    <input type="number" min="0" max="9" class="number-input" id="digit2" maxlength="1">
                    <input type="number" min="0" max="9" class="number-input" id="digit3" maxlength="1">
                    <input type="number" min="0" max="9" class="number-input" id="digit4" maxlength="1">
                </div>
                
                <div class="buttons">
                    <button class="btn btn-submit" id="submitBtn">
                        <i class="fas fa-paper-plane"></i> 提交猜測
                    </button>
                    <button class="btn btn-reset" id="resetBtn">
                        <i class="fas fa-redo"></i> 新遊戲
                    </button>
                    <button class="btn btn-reset" id="Frontpage">
                        <a href="index.html">返回主頁</a> 
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 勝利訊息 -->
        <div class="win-message" id="winMessage">
            <i class="fas fa-trophy"></i> 恭喜！您猜中了數字！
        </div>
        
        <!-- 歷史猜測表格 -->
        <div class="history-section">
            <h2 class="history-title"><i class="fas fa-history"></i> 猜測歷史</h2>
            
            <div class="table-container">
                <table class="history-table" id="historyTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>猜測數字</th>
                            <th>正確位置</th>
                            <th>正確數字</th>
                            <th>時間</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- 表格內容將由JavaScript動態生成 -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 遊戲說明 -->
        <div class="instructions">
            <h3><i class="fas fa-book"></i> 遊戲玩法說明</h3>
            <ul>
                <li>電腦會生成一個隨機的4位數字（0-9，允許重複）</li>
                <li>在右側輸入您的4位數字猜測</li>
                <li>點擊"提交猜測"按鈕或按Enter鍵</li>
                <li>您將獲得兩個回饋：
                    <ul>
                        <li><span class="highlight" style="color: #4CAF50;">正確位置</span>：數字正確且在正確位置上</li>
                        <li><span class="highlight" style="color: #2196F3;">正確數字</span>：數字正確但在錯誤位置上</li>
                    </ul>
                </li>
                <li>使用表格中的歷史記錄來追蹤您的進度</li>
                <li>目標是以最少的嘗試次數猜中所有4個數字在正確位置上</li>
            </ul>
        </div>
    </div>

    <script>
        // 遊戲變數
        let secretNumber = []; // 儲存秘密數字
        let attempts = 0; // 嘗試次數計數器
        let startTime; // 遊戲開始時間
        let timerInterval; // 計時器間隔
        let gameActive = true; // 遊戲活動狀態
        let guessHistory = []; // 猜測歷史記錄
        
        // DOM元素
        const digitInputs = document.querySelectorAll('.number-input'); // 數字輸入框
        const submitBtn = document.getElementById('submitBtn'); // 提交按鈕
        const resetBtn = document.getElementById('resetBtn'); // 重置按鈕
        const attemptsElement = document.getElementById('attempts'); // 嘗試次數顯示元素
        const timerElement = document.getElementById('timer'); // 計時器顯示元素
        const statusElement = document.getElementById('status'); // 狀態顯示元素
        const winMessage = document.getElementById('winMessage'); // 勝利訊息
        const historyTableBody = document.getElementById('historyTableBody'); // 歷史表格內容
        
        // 初始化遊戲
        function initGame() {
            // 生成隨機4位數字（數字0-9，允許重複）
            secretNumber = [];
            for (let i = 0; i < 4; i++) {
                secretNumber.push(Math.floor(Math.random() * 10));
            }
            
            // 重置遊戲狀態
            attempts = 0;
            gameActive = true;
            guessHistory = [];
            attemptsElement.textContent = attempts;
            statusElement.textContent = "遊戲中";
            statusElement.className = "status-playing";
            winMessage.style.display = "none";
            
            // 清除輸入
            digitInputs.forEach(input => {
                input.value = '';
                input.disabled = false;
                input.classList.remove('digit-active');
            });
            
            // 聚焦第一個輸入框
            digitInputs[0].focus();
            digitInputs[0].classList.add('digit-active');
            
            // 啟用提交按鈕
            submitBtn.disabled = false;
            
            // 清除歷史表格
            historyTableBody.innerHTML = '';
            
            // 開始計時器
            startTimer();
            
            // 除錯用：在控制台顯示秘密數字
            console.log("秘密數字：", secretNumber.join(''));
        }
        
        // 開始遊戲計時器
        function startTimer() {
            // 清除現有計時器
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            startTime = new Date();
            
            // 更新計時器每秒
            timerInterval = setInterval(() => {
                const currentTime = new Date();
                const elapsed = Math.floor((currentTime - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                timerElement.textContent = `${minutes}:${seconds}`;
            }, 1000);
        }
        
        // 檢查玩家的猜測
        function checkGuess() {
            // 從輸入框獲取猜測
            const guess = [];
            let validGuess = true;
            
            digitInputs.forEach(input => {
                const value = parseInt(input.value);
                if (isNaN(value) || value < 0 || value > 9) {
                    validGuess = false;
                    input.style.border = "3px solid #FF5722";
                    input.style.backgroundColor = "rgba(255, 87, 34, 0.1)";
                } else {
                    guess.push(value);
                    input.style.border = "";
                    input.style.backgroundColor = "";
                }
            });
            
            // 驗證猜測是否有效
            if (!validGuess) {
                alert("請在所有欄位中輸入有效的數字（0-9）。");
                return;
            }
            
            // 增加嘗試次數
            attempts++;
            attemptsElement.textContent = attempts;
            
            // 計算回饋
            let correctPosition = 0; // 正確位置的數字數量
            let correctNumber = 0; // 正確數字但位置錯誤的數量
            
            // 創建副本以追蹤哪些數字已匹配
            const secretCopy = [...secretNumber];
            const guessCopy = [...guess];
            
            // 第一遍：檢查正確位置
            for (let i = 0; i < 4; i++) {
                if (guess[i] === secretCopy[i]) {
                    correctPosition++;
                    // 標記為已使用
                    secretCopy[i] = null;
                    guessCopy[i] = null;
                }
            }
            
            // 第二遍：檢查正確數字但錯誤位置
            for (let i = 0; i < 4; i++) {
                if (guessCopy[i] !== null) {
                    const foundIndex = secretCopy.indexOf(guessCopy[i]);
                    if (foundIndex !== -1) {
                        correctNumber++;
                        // 標記為已使用
                        secretCopy[foundIndex] = null;
                    }
                }
            }
            
            // 記錄猜測時間
            const currentTime = new Date();
            const elapsed = Math.floor((currentTime - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const seconds = (elapsed % 60).toString().padStart(2, '0');
            const guessTime = `${minutes}:${seconds}`;
            
            // 添加到歷史記錄
            addToHistory(guess, correctPosition, correctNumber, guessTime);
            
            // 檢查是否獲勝
            if (correctPosition === 4) {
                gameWon();
            }
            
            // 清除輸入以供下次猜測
            digitInputs.forEach(input => {
                input.value = '';
            });
            
            // 聚焦第一個輸入框
            digitInputs[0].focus();
            digitInputs[0].classList.add('digit-active');
            
            // 移除其他輸入框的活動狀態
            for (let i = 1; i < digitInputs.length; i++) {
                digitInputs[i].classList.remove('digit-active');
            }
        }
        
        // 添加猜測到歷史記錄表格
        function addToHistory(guess, correctPosition, correctNumber, guessTime) {
            // 創建表格行
            const row = document.createElement('tr');
            
            // 添加嘗試次數單元格
            const attemptCell = document.createElement('td');
            attemptCell.textContent = attempts;
            attemptCell.style.fontWeight = 'bold';
            attemptCell.style.fontSize = '1.2rem';
            row.appendChild(attemptCell);
            
            // 添加猜測數字單元格
            const guessCell = document.createElement('td');
            const guessSpan = document.createElement('span');
            guessSpan.className = 'guess-number';
            guessSpan.textContent = guess.join(' ');
            guessCell.appendChild(guessSpan);
            row.appendChild(guessCell);
            
            // 添加正確位置單元格
            const positionCell = document.createElement('td');
            const positionSpan = document.createElement('span');
            positionSpan.className = 'feedback-counter correct-position-counter';
            positionSpan.textContent = correctPosition;
            positionCell.appendChild(positionSpan);
            row.appendChild(positionCell);
            
            // 添加正確數字單元格
            const numberCell = document.createElement('td');
            const numberSpan = document.createElement('span');
            numberSpan.className = 'feedback-counter correct-number-counter';
            numberSpan.textContent = correctNumber;
            numberCell.appendChild(numberSpan);
            row.appendChild(numberCell);
            
            // 添加時間單元格
            const timeCell = document.createElement('td');
            timeCell.textContent = guessTime;
            timeCell.style.fontFamily = 'monospace';
            timeCell.style.fontSize = '1.1rem';
            row.appendChild(timeCell);
            
            // 添加到表格頂部
            historyTableBody.insertBefore(row, historyTableBody.firstChild);
            
            // 限制歷史記錄為15行
            if (historyTableBody.children.length > 15) {
                historyTableBody.removeChild(historyTableBody.lastChild);
            }
            
            // 保存到歷史記錄陣列
            guessHistory.unshift({
                attempt: attempts,
                guess: [...guess],
                correctPosition: correctPosition,
                correctNumber: correctNumber,
                time: guessTime
            });
        }
        
        // 處理遊戲勝利
        function gameWon() {
            gameActive = false;
            statusElement.textContent = "勝利！";
            statusElement.className = "status-won";
            winMessage.style.display = "block";
            
            // 停止計時器
            clearInterval(timerInterval);
            
            // 停用輸入框
            digitInputs.forEach(input => {
                input.disabled = true;
                input.classList.remove('digit-active');
            });
            
            // 停用提交按鈕
            submitBtn.disabled = true;
            
            // 添加五彩紙屑效果
            createConfetti();
        }
        
        // 創建簡單的五彩紙屑效果
        function createConfetti() {
            const colors = ['#ffeb3b', '#4CAF50', '#2196F3', '#FF9800', '#E91E63'];
            
            for (let i = 0; i < 80; i++) {
                // 創建五彩紙屑元素
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '12px';
                confetti.style.height = '12px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-20px';
                confetti.style.zIndex = '9999';
                confetti.style.opacity = '0.9';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                // 動畫五彩紙屑
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(${window.innerHeight + 20}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: 3000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                });
                
                // 動畫結束後移除五彩紙屑
                animation.onfinish = () => {
                    if (confetti.parentNode) {
                        document.body.removeChild(confetti);
                    }
                };
            }
        }
        
        // 處理輸入導航
        digitInputs.forEach((input, index) => {
            // 輸入時自動前進到下一個輸入框
            input.addEventListener('input', (e) => {
                // 更新活動狀態
                digitInputs.forEach(inp => inp.classList.remove('digit-active'));
                input.classList.add('digit-active');
                
                if (e.target.value.length === 1 && index < 3) {
                    digitInputs[index + 1].focus();
                    digitInputs[index + 1].classList.add('digit-active');
                }
                
                // 限制為一個數字
                if (e.target.value.length > 1) {
                    e.target.value = e.target.value.slice(0, 1);
                }
            });
            
            // 允許退格鍵返回上一個輸入框
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
                    digitInputs[index - 1].focus();
                    digitInputs[index - 1].classList.add('digit-active');
                    input.classList.remove('digit-active');
                }
                
                // 按Enter鍵提交
                if (e.key === 'Enter') {
                    if (index === 3) {
                        checkGuess();
                    } else {
                        digitInputs[index + 1].focus();
                        digitInputs[index + 1].classList.add('digit-active');
                        input.classList.remove('digit-active');
                    }
                }
                
                // 按箭頭鍵導航
                if (e.key === 'ArrowLeft' && index > 0) {
                    digitInputs[index - 1].focus();
                    digitInputs[index - 1].classList.add('digit-active');
                    input.classList.remove('digit-active');
                }
                
                if (e.key === 'ArrowRight' && index < 3) {
                    digitInputs[index + 1].focus();
                    digitInputs[index + 1].classList.add('digit-active');
                    input.classList.remove('digit-active');
                }
            });
            
            // 點擊時添加活動狀態
            input.addEventListener('click', () => {
                digitInputs.forEach(inp => inp.classList.remove('digit-active'));
                input.classList.add('digit-active');
            });
            
            // 失去焦點時移除活動狀態
            input.addEventListener('blur', () => {
                // 延遲移除活動狀態，以便導航正常工作
                setTimeout(() => {
                    input.classList.remove('digit-active');
                }, 100);
            });
        });
        
        // 按鈕的事件監聽器
        submitBtn.addEventListener('click', checkGuess);
        
        resetBtn.addEventListener('click', initGame);
        
        // 頁面載入時初始化遊戲
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>